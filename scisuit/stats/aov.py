import math
import numbers
import numpy as np
from dataclasses import dataclass

from .distributions import pf
from ..fitting import linearinterp


__all__ = ['aov', 'aov2_results', 'aov']



#Used by One-way ANOVA
def qdist(alpha, k, df):
	pass



#Used by 2-way ANOVA
def _parsedata(y, x1, x2, v1, v2):
	"""
	parse the data that comes in the format of y, x1, x2 to
	columns of x1 (v1 columns) and rows of x2 (v1 columns)

	The formatted data looks like how Excel accepts data for 2-factor ANOVA
	"""
	Tbl = []
	for i in range(len(v2)):
		Tbl.append(list())
		for j in range(len(v1)):
			Tbl[i].append(list())

	for k in range(len(y)):
		i, j = -1, -1

		while (True):
			i += 1 
			if x2[k] == v2[i]: break

		while (True):
			j +=1
			if x1[k] == v1[j]: break
		
		Tbl[i][j].append(y[k])
	
	return Tbl


#Used by 2-way ANOVA
def _averageMatrix(Tbl, v2):
	"""
	contains average value of each cell's data list
	"""
	MatAverage = []
	for i in range(len(v2)):
		arr = np.array(Tbl[i]).transpose()
		v = arr.mean(axis = 0)
		MatAverage.append(v.tolist())
	return MatAverage






class aov: 

	class TukeyComparison:
		def __init__(self) -> None:
			self.m_a=None
			self.m_b=None
			self.m_MeanValueDiff=None
			self.m_CILow=None
			self.m_CIHigh=None

		def __str__(self) -> str: 
			retStr = str(self.m_a) + "-" + str(self.m_b) + \
				"\t \t" + \
				str(round(self.m_MeanValueDiff, 2)) + \
				"\t \t" + \
				str(round(self.m_CILow, 2)) + \
				"," \
				+ str(round(self.m_CIHigh, 2))
			return retStr


	def __init__(self, *args) -> None:
		self.m_args = args
		self.m_Averages = []
		self.m_SampleSizes = []

		self.m_MSError=None
		self.m_DFTreatment=None
		self.m_DFError=None
		self.m_TukeyTable=[]
		self.m_pvalue = None



	def compute(self):
		SS_Treatment, SS_Error, SS_Total=0, 0, 0
		NEntries = 0

		#C is a variable defined to speed up computations (see Larsen Marx Chapter 12 on ANOVA)
		C = 0

		for elem in self.m_args:
			TypeOK=isinstance(elem, list) or isinstance(elem, np.ndarray)
			if(TypeOK == False):
				raise TypeError("list/ndarray expected")

			ElemSize = len(elem)
			LocalSum=0
			
			for entry in elem:
				LocalSum += entry
				SS_Total += entry**2
			
			#Required for Tukey test
			self.m_Averages.append(LocalSum/ElemSize)
			self.m_SampleSizes.append(ElemSize) 

			C += LocalSum
			NEntries += ElemSize
			SS_Treatment += LocalSum**2/ElemSize

            
		C = C**2 / NEntries
		
		SS_Total = SS_Total - C
		SS_Treatment = SS_Treatment - C
		SS_Error = SS_Total - SS_Treatment

		self.m_DFError, self.m_DFTreatment = NEntries-len(self.m_args), len(self.m_args)-1 
		DF_Total = self.m_DFError + self.m_DFTreatment

		MS_Treatment, self.m_MSError = SS_Treatment/self.m_DFTreatment , SS_Error/self.m_DFError

		Fvalue = MS_Treatment/self.m_MSError

		self.m_pvalue = 1 - pf(q = Fvalue, df1 = self.m_DFTreatment, df2 = self.m_DFError)

		Dict = dict()
		Dict["Treatment"] = {'DF':self.m_DFTreatment, 'SS':SS_Treatment, 'MS':MS_Treatment}
		Dict["Error"] = {'DF':self.m_DFError, 'SS':SS_Error, 'MS':self.m_MSError}
		Dict["Total"] = {'DF':DF_Total, 'SS':SS_Total, 'MS': SS_Total/DF_Total}
		Dict["Fvalue"] = Fvalue


		return self.m_pvalue, Dict



	def tukey(self, Alpha)->list:
		"""
		perform tukey test \n

		tukey(Alpha)-> list
		"""
		
		if(len(self.m_Averages) == 0):
			raise RuntimeError("first compute must be called")
		
		if(isinstance(Alpha, numbers.Number) == False):
			raise TypeError("Alpha must be of type number")

		D = qdist(1-Alpha, self.m_DFTreatment-1, self.m_DFError-1) / math.sqrt(self.m_SampleSizes[0])
		ConfIntervalLength = D*math.sqrt(self.m_MSError)

		self.m_TukeyTable=[]
		for i in range(len(self.m_Averages)):
			for j in range(i+1, len(self.m_Averages)):
				MeanValueDiff = self.m_Averages[i]-self.m_Averages[j]
				ConfInterval1 = MeanValueDiff-ConfIntervalLength
				ConfInterval2 = MeanValueDiff+ConfIntervalLength

				com = self.TukeyComparison()

				com.m_a=i
				com.m_b=j
				com.m_MeanValueDiff=MeanValueDiff
				com.m_CILow = min(ConfInterval1,ConfInterval2)
				com.m_CIHigh = max(ConfInterval1,ConfInterval2)

				self.m_TukeyTable.append(com)

		return self.m_TukeyTable


	def __str__(self) -> str:
		if(isinstance(self.m_pvalue, numbers.Number) == False):
				raise RuntimeError("compute method has not been called")
		
		retStr= "p-value = " + str(self.m_pvalue) + "\n"

		retStr += "Pairs \t \t Diff  \t \t Tukey Interval"
		retStr +="\n"
		
		for Entry in self.m_TukeyTable:
				retStr += str(Entry)
				retStr += "\n"
		
		return retStr
	



@dataclass
class aov2_results():
	DFError:int; DFFact1:int; DFFact2:int; DFinteract:int
	FvalFact1:float; FvalFact2:float; Fvalinteract:float
	MSError:float; MSFact1:float; MSFact2:float; MSinteract:float
	pvalFact1:float; pvalFact2:float; pvalinteract:float
	SSError:float; SSFact1:float; SSFact2:float; SSinteract:float

	Residuals:list
	Fits:list


def aov2(y, x1, x2):
	"""
	Performs 2-way ANOVA

	## Input
	y: Responses \n
	x1, x2: factors
	"""
	X1 = x1
	if isinstance(x1, list):
		X1 = np.asfarray(x1)
	
	X2 = x2
	if isinstance(x2, list):
		X2 = np.asfarray(x2)
	
	YY = y
	if isinstance(y, list):
		YY = np.asfarray(y)

	assert len(X1)>= 3, "x1 must have at least 3 elements"
	assert len(X2) == len(X1), "x1 and x2 must have same size"
	assert len(X1) == len(YY), "x1 and y must have same size"

	assert np.issubdtype(X1.dtype, np.number), "x1 must contain only numbers"
	assert np.issubdtype(X2.dtype, np.number), "x2 must contain only numbers"
	assert np.issubdtype(YY.dtype, np.number), "y must contain only numbers"

	v1 = np.unique(X1)
	v2 = np.unique(X2)

	Tbl = _parsedata(YY, X1, X2, v1, v2)
	MatAverage = _averageMatrix(Tbl, v2)

	SSerror = 0
	Residuals, Fits = [], []

	for i in range(len(v2)):
		for j in range(len(v1)):
			sz = len(Tbl[i][j])
			for k in range(sz):
				Err = Tbl[i][j][k] - MatAverage[i][j]
				SSerror += Err**2.0

				Residuals.append(Err)
				Fits.append(MatAverage[i][j])

	MatAverage = np.array(MatAverage)
	GrandMean = MatAverage.mean()
	Nreplicate = len(Tbl[0][0])
	DFerror = (Nreplicate - 1) * (len(v1)) * (len(v2))
	MSerror = SSerror / DFerror

	meanj = MatAverage.mean(axis = 0)
	meani = MatAverage.transpose().mean(axis = 0)

	DFFact1, DFFact2 = len(v1) - 1, len(v2) - 1
	SSFact1 = np.sum((meanj - GrandMean)**2) * Nreplicate * len(v2)
	SSFact2 = np.sum((meani - GrandMean)**2) * Nreplicate * len(v1)
	MSFact1, MSFact2 = SSFact1 / DFFact1, SSFact2 / DFFact2

	SSinteract = 0
	for i in range(len(v2)):
		for j in range(len(v1)):
			SSinteract += (MatAverage[i, j] - meanj[j] - meani[i] + GrandMean)**2

	SSinteract *= Nreplicate
	DFinteract = DFFact1 * DFFact2
	MSinteract = SSinteract / DFinteract

	FvalFact1, FvalFact2, Fvalinteract = MSFact1 / MSerror, MSFact2 / MSerror, MSinteract / MSerror
	pvalFact1 = 1.0 - pf(FvalFact1, DFFact1, DFerror)
	pvalFact2 = 1.0 - pf(FvalFact2, DFFact2, DFerror)
	pvalinteract = 1.0 - pf(Fvalinteract, DFinteract, DFerror)

	return aov2_results(
		DFError=DFerror, DFFact1=DFFact1, DFFact2=DFFact2,DFinteract=DFinteract,
		FvalFact1=FvalFact1, FvalFact2 =FvalFact2, Fvalinteract = Fvalinteract,
		MSError = MSerror, MSFact1 = MSFact1, MSFact2 = MSFact2, MSinteract= MSinteract,
		pvalFact1 = pvalFact1, pvalFact2 = pvalFact2, pvalinteract= pvalinteract,
		SSError = SSerror, SSFact1 = SSFact1, SSFact2 = SSFact2, SSinteract=SSinteract,

		Fits=Fits,
		Residuals=Residuals
	)





qdist095=[None,
[6.0849,8.3308,9.798,10.881,11.734,12.4345,13.0266,13.5381,13.9875,14.3874,14.7473,15.0757,15.3748,15.6503,15.9054,16.1427,16.3646,16.5728,16.7688],
[4.5007,5.9096,6.8245,7.5016,8.037,8.478,8.8521,9.1766,9.462,9.7166,9.946,10.1547,10.3459,10.5222,10.6856,10.8378,10.9803,11.114,11.24],
[3.9265,5.0403,5.7571,6.287,6.7065,7.0528,7.3465,7.6015,7.8264,8.0271,8.2083,8.3732,8.5244,8.664,8.7934,8.9141,9.0271,9.1332,9.2333],
[3.6354,4.6017,5.2185,5.6731,6.0329,6.3299,6.5823,6.8014,6.9947,7.1674,7.3237,7.4653,7.5956,7.7163,7.828,7.9322,8.0298,8.1215,8.208],
[3.4605,4.339,4.8956,5.3049,5.6285,5.8953,6.1222,6.3192,6.4931,6.6485,6.789,6.9169,7.0344,7.1428,7.2436,7.3375,7.4256,7.5086,7.5866],
[3.3439,4.1648,4.6812,5.0601,5.3591,5.6058,5.8154,5.9975,6.1581,6.3018,6.4314,6.5497,6.6583,6.7586,6.8518,6.9387,7.0202,7.0968,7.1691],
[3.2612,4.041,4.5288,4.8858,5.1672,5.3991,5.5962,5.7673,5.9183,6.0534,6.1754,6.2867,6.3888,6.4832,6.5708,6.6527,6.7293,6.8015,6.8695],
[3.1991,3.9485,4.4149,4.7554,5.0235,5.2444,5.4319,5.5947,5.7384,5.8669,5.983,6.0888,6.186,6.2758,6.3592,6.4371,6.5101,6.5787,6.6435],
[3.1511,3.8768,4.3266,4.6543,4.912,5.1242,5.3042,5.4605,5.5984,5.7217,5.8331,5.9346,6.0279,6.1141,6.1941,6.2689,6.3389,6.4048,6.467],
[3.1127,3.8195,4.2561,4.5736,4.8229,5.0281,5.2021,5.3531,5.4863,5.6054,5.7129,5.8111,5.9012,5.9844,6.0617,6.1339,6.2015,6.2652,6.3252],
[3.0813,3.7728,4.1985,4.5076,4.7477,4.9469,5.1159,5.2625,5.3946,5.5102,5.6146,5.7098,5.7973,5.8781,5.9532,6.0231,6.0888,6.1506,6.2089],
[3.0553,3.7341,4.1509,4.4529,4.6897,4.8841,5.049,5.192,5.3181,5.4308,5.5326,5.6253,5.7105,5.7892,5.8623,5.9305,5.9945,6.0547,6.1116],
[3.0332,3.7014,4.1105,4.4066,4.6385,4.829,4.9903,5.13,5.2533,5.3635,5.463,5.5537,5.637,5.7139,5.7854,5.8521,5.9146,5.9735,6.029],
[3.0143,3.6734,4.076,4.367,4.5947,4.7816,4.9399,5.077,5.1979,5.3059,5.4033,5.4922,5.5738,5.6492,5.7193,5.7847,5.8459,5.9036,5.958],
[2.998,3.6491,4.0461,4.3327,4.5568,4.7406,4.8962,5.031,5.1498,5.2559,5.3517,5.439,5.5191,5.5931,5.6619,5.7261,5.7862,5.8429,5.8963],
[2.9837,3.628,4.02,4.3027,4.5237,4.7048,4.858,4.9907,5.1077,5.2121,5.3064,5.3923,5.4712,5.544,5.6117,5.6748,5.7339,5.7896,5.8421],
[2.9712,3.6093,3.997,4.2763,4.4944,4.6731,4.8243,4.9552,5.0705,5.1735,5.2664,5.3511,5.4288,5.5006,5.5672,5.6295,5.6878,5.7426,5.7944],
[2.96,3.5927,3.9766,4.2528,4.4685,4.645,4.7944,4.9236,5.0375,5.1391,5.2308,5.3144,5.3911,5.4619,5.5277,5.5891,5.6466,5.7007,5.7518],
[2.95,3.5779,3.9583,4.2319,4.4452,4.6199,4.7676,4.8954,5.0079,5.1083,5.199,5.2815,5.3573,5.4273,5.4923,5.5529,5.6097,5.6632,5.7136],
[2.941,3.5646,3.9419,4.213,4.4244,4.5973,4.7435,4.8699,4.9813,5.0806,5.1703,5.252,5.3269,5.3961,5.4603,5.5203,5.5765,5.6293,5.6792],
[2.9329,3.5526,3.927,4.1959,4.4055,4.5769,4.7217,4.8469,4.9572,5.0556,5.1443,5.2252,5.2993,5.3678,5.4314,5.4908,5.5464,5.5987,5.648],
[2.9255,3.5417,3.9136,4.1805,4.3883,4.5583,4.7019,4.826,4.9353,5.0328,5.1207,5.2008,5.2743,5.3421,5.4051,5.4639,5.5189,5.5707,5.6196],
[2.9188,3.5317,3.9013,4.1663,4.3727,4.5413,4.6838,4.8069,4.9153,5.0119,5.0991,5.1785,5.2514,5.3186,5.381,5.4393,5.4939,5.5452,5.5936],
[2.9126,3.5226,3.89,4.1534,4.3583,4.5258,4.6672,4.7894,4.8969,4.9928,5.0793,5.1581,5.2303,5.297,5.359,5.4167,5.4709,5.5218,5.5698],
[2.907,3.5142,3.8796,4.1415,4.3451,4.5115,4.6519,4.7733,4.88,4.9753,5.0611,5.1393,5.211,5.2772,5.3387,5.396,5.4497,5.5002,5.5478],
[2.9017,3.5064,3.8701,4.1305,4.3329,4.4983,4.6378,4.7584,4.8645,4.959,5.0443,5.122,5.1931,5.2589,5.3199,5.3768,5.4301,5.4802,5.5275],
[2.8969,3.4992,3.8612,4.1203,4.3217,4.4861,4.6248,4.7446,4.85,4.944,5.0287,5.1059,5.1766,5.2419,5.3025,5.359,5.412,5.4618,5.5087],
[2.8924,3.4926,3.853,4.1109,4.3112,4.4747,4.6127,4.7319,4.8366,4.93,5.0143,5.0909,5.1612,5.2261,5.2863,5.3425,5.3951,5.4446,5.4913],
[2.8882,3.4865,3.8454,4.1021,4.3015,4.4642,4.6014,4.7199,4.8241,4.917,5.0008,5.077,5.1469,5.2114,5.2713,5.3271,5.3794,5.4286,5.475],
[2.8843,3.4806,3.8383,4.0939,4.2924,4.4543,4.5909,4.7088,4.8125,4.9049,4.9882,5.064,5.1335,5.1977,5.2572,5.3127,5.3647,5.4136,5.4597],
[2.8807,3.4752,3.8316,4.0862,4.2839,4.4451,4.5811,4.6984,4.8016,4.8936,4.9765,5.0519,5.121,5.1848,5.244,5.2993,5.351,5.3996,5.4455],
[2.8773,3.4702,3.8254,4.079,4.2759,4.4365,4.5718,4.6887,4.7914,4.8829,4.9654,5.0405,5.1093,5.1728,5.2317,5.2866,5.3381,5.3865,5.4321],
[2.874,3.4654,3.8195,4.0723,4.2684,4.4284,4.5632,4.6795,4.7818,4.8729,4.955,5.0298,5.0982,5.1614,5.2201,5.2748,5.326,5.3741,5.4196],
[2.871,3.461,3.814,4.066,4.2614,4.4207,4.555,4.6709,4.7728,4.8635,4.9453,5.0197,5.0879,5.1508,5.2091,5.2636,5.3146,5.3625,5.4077],
[2.8682,3.4568,3.8088,4.06,4.2548,4.4136,4.5473,4.6628,4.7642,4.8546,4.9361,5.0102,5.0781,5.1407,5.1988,5.253,5.3038,5.3515,5.3965],
[2.8655,3.4528,3.8039,4.0543,4.2485,4.4068,4.5401,4.6551,4.7562,4.8462,4.9274,5.0012,5.0688,5.1312,5.1891,5.2431,5.2936,5.3412,5.386],
[2.863,3.449,3.7993,4.049,4.2426,4.4003,4.5332,4.6479,4.7486,4.8383,4.9191,4.9927,5.06,5.1222,5.1799,5.2337,5.284,5.3313,5.376],
[2.8605,3.4455,3.7949,4.0439,4.237,4.3942,4.5267,4.641,4.7414,4.8308,4.9113,4.9846,5.0517,5.1137,5.1711,5.2247,5.2749,5.322,5.3665],
[2.8583,3.4421,3.7907,4.0391,4.2317,4.3885,4.5205,4.6345,4.7345,4.8237,4.9039,4.977,5.0439,5.1056,5.1629,5.2162,5.2662,5.3132,5.3575],
[2.8561,3.4389,3.7867,4.0346,4.2266,4.383,4.5147,4.6283,4.728,4.8169,4.8969,4.9697,5.0364,5.0979,5.155,5.2082,5.258,5.3048,5.349],
[2.854,3.4358,3.783,4.0302,4.2218,4.3778,4.5091,4.6224,4.7218,4.8104,4.8902,4.9628,5.0293,5.0906,5.1475,5.2005,5.2502,5.2968,5.3408],
[2.8521,3.4329,3.7794,4.0261,4.2172,4.3728,4.5038,4.6168,4.716,4.8043,4.8839,4.9562,5.0225,5.0836,5.1403,5.1932,5.2427,5.2892,5.3331],
[2.8502,3.4302,3.776,4.0222,4.2128,4.3681,4.4987,4.6114,4.7103,4.7984,4.8778,4.9499,5.016,5.077,5.1335,5.1862,5.2356,5.282,5.3257],
[2.8484,3.4275,3.7727,4.0184,4.2087,4.3635,4.4939,4.6063,4.705,4.7928,4.872,4.9439,5.0098,5.0706,5.127,5.1796,5.2288,5.275,5.3186],
[2.8467,3.425,3.7696,4.0148,4.2047,4.3592,4.4893,4.6014,4.6998,4.7875,4.8664,4.9382,5.0039,5.0646,5.1208,5.1732,5.2223,5.2684,5.3119],
[2.8451,3.4226,3.7666,4.0114,4.2009,4.3551,4.4849,4.5967,4.6949,4.7824,4.8611,4.9327,4.9983,5.0587,5.1148,5.1671,5.2161,5.2621,5.3054],
[2.8435,3.4203,3.7637,4.0081,4.1972,4.3511,4.4806,4.5923,4.6903,4.7775,4.856,4.9275,4.9929,5.0532,5.1091,5.1613,5.2101,5.256,5.2992],
[2.842,3.418,3.761,4.005,4.1938,4.3474,4.4766,4.588,4.6858,4.7728,4.8512,4.9224,4.9877,5.0479,5.1037,5.1557,5.2044,5.2502,5.2933],
[2.8406,3.4159,3.7584,4.002,4.1904,4.3437,4.4727,4.5839,4.6814,4.7683,4.8465,4.9176,4.9827,5.0427,5.0984,5.1503,5.1989,5.2446,5.2876],
[2.8392,3.4139,3.7559,3.9991,4.1872,4.3402,4.469,4.5799,4.6773,4.764,4.842,4.913,4.9779,5.0378,5.0934,5.1452,5.1937,5.2392,5.2822],
[2.8379,3.4119,3.7535,3.9963,4.1841,4.3369,4.4654,4.5761,4.6733,4.7598,4.8377,4.9085,4.9733,5.0331,5.0886,5.1402,5.1886,5.234,5.2769],
[2.8366,3.41,3.751,3.9936,4.1811,4.3337,4.4619,4.5725,4.6695,4.7558,4.8336,4.9042,4.9689,5.0286,5.0839,5.1355,5.1837,5.2291,5.2718],
[2.8354,3.4082,3.7489,3.991,4.1783,4.3305,4.4586,4.569,4.6658,4.752,4.8296,4.9001,4.9647,5.0242,5.0794,5.1309,5.1791,5.2243,5.267],
[2.8342,3.4065,3.7468,3.9885,4.1755,4.3276,4.4554,4.5656,4.6623,4.7483,4.8257,4.8961,4.9606,5.02,5.0751,5.1265,5.1745,5.2197,5.2623],
[2.8331,3.4048,3.7448,3.9862,4.1729,4.3247,4.4524,4.5623,4.6589,4.7447,4.822,4.8923,4.9566,5.016,5.071,5.1222,5.1702,5.2153,5.2578],
[2.832,3.4032,3.7427,3.9839,4.1703,4.3219,4.4494,4.5592,4.6556,4.7413,4.8185,4.8886,4.9528,5.0121,5.067,5.1181,5.166,5.211,5.2534],
[2.8309,3.4016,3.7408,3.9816,4.1678,4.3192,4.4465,4.5562,4.6524,4.738,4.815,4.885,4.9492,5.0083,5.0631,5.1142,5.162,5.2069,5.2492],
[2.8299,3.4001,3.7389,3.9795,4.1655,4.3166,4.4438,4.5533,4.6493,4.7348,4.8117,4.8816,4.9456,5.0046,5.0594,5.1103,5.1581,5.2029,5.2452],
[2.8289,3.3987,3.7371,3.9774,4.1632,4.3142,4.4411,4.5504,4.6463,4.7317,4.8085,4.8783,4.9422,5.0011,5.0557,5.1066,5.1543,5.199,5.2412],
[2.828,3.3973,3.7354,3.9754,4.1609,4.3117,4.4385,4.5477,4.6435,4.7287,4.8054,4.8751,4.9389,4.9977,5.0523,5.1031,5.1506,5.1953,5.2374],
[2.8271,3.3959,3.7337,3.9735,4.1588,4.3094,4.436,4.5451,4.6407,4.7258,4.8024,4.872,4.9357,4.9944,5.0489,5.0996,5.1471,5.1917,5.2338],
[2.8262,3.3946,3.732,3.9716,4.1567,4.3071,4.4336,4.5425,4.638,4.723,4.7995,4.869,4.9326,4.9912,5.0456,5.0963,5.1437,5.1882,5.2302],
[2.8253,3.3933,3.7305,3.9698,4.1547,4.305,4.4313,4.54,4.6354,4.7203,4.7967,4.8661,4.9296,4.9881,5.0424,5.093,5.1404,5.1848,5.2268],
[2.8245,3.3921,3.7289,3.968,4.1527,4.3028,4.429,4.5376,4.6329,4.7177,4.7939,4.8632,4.9267,4.9852,5.0394,5.0899,5.1372,5.1816,5.2234],
[2.8237,3.3909,3.7275,3.9663,4.1509,4.3008,4.4268,4.5353,4.6305,4.7151,4.7913,4.8605,4.9239,4.9823,5.0364,5.0868,5.1341,5.1784,5.2202],
[2.8229,3.3897,3.726,3.9647,4.149,4.2988,4.4247,4.533,4.6281,4.7126,4.7887,4.8578,4.9211,4.9794,5.0335,5.0839,5.131,5.1753,5.2171],
[2.8221,3.3886,3.7246,3.9631,4.1472,4.2969,4.4226,4.5309,4.6258,4.7102,4.7862,4.8553,4.9185,4.9767,5.0307,5.081,5.1281,5.1723,5.214],
[2.8214,3.3875,3.7233,3.9615,4.1455,4.295,4.4206,4.5287,4.6236,4.7079,4.7838,4.8528,4.9159,4.9741,5.028,5.0783,5.1253,5.1694,5.2111],
[2.8207,3.3864,3.722,3.96,4.1438,4.2932,4.4186,4.5267,4.6214,4.7057,4.7815,4.8503,4.9134,4.9715,5.0254,5.0756,5.1225,5.1666,5.2082],
[2.82,3.3854,3.7207,3.9585,4.1422,4.2914,4.4168,4.5247,4.6193,4.7035,4.7792,4.848,4.911,4.969,5.0228,5.0729,5.1198,5.1639,5.2054],
[2.8193,3.3844,3.7195,3.9571,4.1406,4.2897,4.4149,4.5227,4.6173,4.7013,4.777,4.8457,4.9086,4.9666,5.0203,5.0704,5.1172,5.1612,5.2027],
[2.8186,3.3834,3.7183,3.9557,4.1391,4.288,4.4131,4.5208,4.6153,4.6993,4.7748,4.8435,4.9063,4.9642,5.0179,5.0679,5.1147,5.1586,5.2001],
[2.818,3.3825,3.7171,3.9544,4.1376,4.2864,4.4114,4.519,4.6133,4.6972,4.7727,4.8413,4.9041,4.9619,5.0155,5.0655,5.1122,5.1561,5.1975],
[2.8174,3.3816,3.716,3.9531,4.1361,4.2848,4.4097,4.5172,4.6115,4.6953,4.7707,4.8392,4.9019,4.9597,5.0132,5.0631,5.1098,5.1537,5.195],
[2.8167,3.3807,3.7149,3.9518,4.1347,4.2833,4.4081,4.5155,4.6096,4.6934,4.7687,4.8371,4.8998,4.9575,5.011,5.0609,5.1075,5.1513,5.1926],
[2.8161,3.3798,3.7138,3.9506,4.1333,4.2818,4.4064,4.5138,4.6078,4.6915,4.7668,4.8351,4.8977,4.9554,5.0088,5.0586,5.1052,5.149,5.1902],
[2.8155,3.3789,3.7127,3.9494,4.132,4.2803,4.4049,4.5121,4.6061,4.6897,4.7649,4.8332,4.8957,4.9533,5.0067,5.0565,5.103,5.1467,5.1879],
[2.8149,3.3781,3.7117,3.9482,4.1307,4.2789,4.4034,4.5105,4.6044,4.6879,4.7631,4.8313,4.8938,4.9513,5.0047,5.0544,5.1008,5.1445,5.1857],
[2.8144,3.3773,3.7107,3.947,4.1294,4.2775,4.4019,4.5089,4.6028,4.6862,4.7613,4.8295,4.8919,4.9494,5.0027,5.0523,5.0987,5.1424,5.1835],
[2.8138,3.3765,3.7097,3.9459,4.1282,4.2761,4.4004,4.5074,4.6012,4.6845,4.7595,4.8277,4.89,4.9474,5.0007,5.0503,5.0967,5.1403,5.1813],
[2.8133,3.3758,3.7088,3.9448,4.127,4.2748,4.399,4.5059,4.5996,4.6829,4.7578,4.8259,4.8882,4.9456,4.9988,5.0483,5.0947,5.1382,5.1793],
[2.8128,3.375,3.7079,3.9437,4.1258,4.2735,4.3977,4.5045,4.5981,4.6813,4.7562,4.8242,4.8864,4.9438,4.9969,5.0464,5.0927,5.1362,5.1772],
[2.8123,3.3743,3.707,3.9427,4.1246,4.2723,4.3963,4.503,4.5966,4.6798,4.7546,4.8225,4.8847,4.942,4.9951,5.0446,5.0908,5.1343,5.1753],
[2.8118,3.3736,3.7061,3.9417,4.1235,4.2711,4.395,4.5016,4.5951,4.6782,4.753,4.8209,4.883,4.9403,4.9933,5.0427,5.089,5.1324,5.1733],
[2.8114,3.3729,3.7052,3.9407,4.1224,4.2699,4.3937,4.5003,4.5937,4.6767,4.7515,4.8193,4.8814,4.9386,4.9916,5.041,5.0872,5.1305,5.1714],
[2.8109,3.3722,3.7044,3.9397,4.1213,4.2687,4.3925,4.499,4.5923,4.6753,4.7499,4.8177,4.8798,4.9369,4.9899,5.0392,5.0854,5.1287,5.1696],
[2.8105,3.3715,3.7036,3.9388,4.1203,4.2676,4.3913,4.4977,4.591,4.6739,4.7485,4.8162,4.8782,4.9353,4.9882,5.0375,5.0836,5.127,5.1678],
[2.81,3.3709,3.7028,3.9378,4.1192,4.2664,4.3901,4.4964,4.5896,4.6725,4.747,4.8147,4.8767,4.9337,4.9866,5.0359,5.0819,5.1252,5.166],
[2.8096,3.3702,3.702,3.9369,4.1182,4.2654,4.3889,4.4952,4.5883,4.6711,4.7456,4.8133,4.8752,4.9322,4.985,5.0342,5.0803,5.1235,5.1643],
[2.8092,3.3696,3.7012,3.9361,4.1173,4.2643,4.3878,4.494,4.5871,4.6698,4.7443,4.8118,4.8737,4.9307,4.9835,5.0327,5.0787,5.1219,5.1626],
[2.8088,3.369,3.7005,3.9352,4.1163,4.2633,4.3866,4.4928,4.5858,4.6685,4.7429,4.8104,4.8722,4.9292,4.982,5.0311,5.0771,5.1203,5.161],
[2.8083,3.3684,3.6997,3.9344,4.1154,4.2622,4.3855,4.4916,4.5846,4.6673,4.7416,4.8091,4.8708,4.9277,4.9805,5.0296,5.0755,5.1187,5.1593],
[2.808,3.3678,3.699,3.9336,4.1144,4.2612,4.3845,4.4905,4.5834,4.666,4.7403,4.8077,4.8695,4.9263,4.979,5.0281,5.074,5.1171,5.1578],
[2.8076,3.3673,3.6983,3.9327,4.1135,4.2603,4.3834,4.4894,4.5823,4.6648,4.739,4.8064,4.8681,4.925,4.9776,5.0267,5.0725,5.1156,5.1562],
[2.8072,3.3667,3.6976,3.9319,4.1127,4.2593,4.3824,4.4883,4.5811,4.6636,4.7378,4.8052,4.8668,4.9236,4.9762,5.0252,5.0711,5.1141,5.1547],
[2.8068,3.3662,3.6969,3.9312,4.1118,4.2584,4.3814,4.4873,4.58,4.6625,4.7366,4.8039,4.8655,4.9223,4.9749,5.0238,5.0697,5.1127,5.1532],
[2.8065,3.3656,3.6963,3.9304,4.111,4.2574,4.3804,4.4862,4.5789,4.6613,4.7354,4.8027,4.8643,4.921,4.9735,5.0225,5.0683,5.1113,5.1518],
[2.8061,3.3651,3.6956,3.9297,4.1101,4.2566,4.3795,4.4852,4.5778,4.6602,4.7343,4.8015,4.863,4.9197,4.9722,5.0211,5.0669,5.1099,5.1503],
[2.8058,3.3646,3.695,3.9289,4.1093,4.2557,4.3785,4.4842,4.5768,4.6591,4.7331,4.8003,4.8618,4.9185,4.9709,5.0198,5.0656,5.1085,5.149],
[2.8054,3.3641,3.6944,3.9282,4.1085,4.2548,4.3776,4.4832,4.5758,4.658,4.732,4.7992,4.8606,4.9172,4.9697,5.0185,5.0642,5.1072,5.1476],
[2.8051,3.3636,3.6938,3.9275,4.1077,4.254,4.3767,4.4823,4.5748,4.657,4.7309,4.798,4.8595,4.916,4.9685,5.0173,5.063,5.1058,5.1462],
[2.8048,3.3631,3.6932,3.9268,4.107,4.2531,4.3758,4.4813,4.5738,4.656,4.7299,4.7969,4.8583,4.9149,4.9673,5.0161,5.0617,5.1045,5.1449],
[2.8044,3.3627,3.6926,3.9262,4.1062,4.2523,4.3749,4.4804,4.5728,4.6549,4.7288,4.7958,4.8572,4.9137,4.9661,5.0148,5.0605,5.1033,5.1436],
[2.8041,3.3622,3.692,3.9255,4.1055,4.2515,4.3741,4.4795,4.5719,4.654,4.7278,4.7948,4.8561,4.9126,4.9649,5.0137,5.0592,5.102,5.1424],
[2.8038,3.3617,3.6915,3.9249,4.1048,4.2507,4.3733,4.4786,4.5709,4.653,4.7268,4.7937,4.855,4.9115,4.9638,5.0125,5.0581,5.1008,5.1411],
[2.8035,3.3613,3.6909,3.9242,4.1041,4.25,4.3724,4.4778,4.57,4.652,4.7258,4.7927,4.854,4.9104,4.9627,5.0113,5.0569,5.0996,5.1399],
[2.8032,3.3609,3.6904,3.9236,4.1034,4.2492,4.3716,4.4769,4.5691,4.6511,4.7248,4.7917,4.8529,4.9093,4.9616,5.0102,5.0557,5.0985,5.1387],
[2.8029,3.3604,3.6898,3.923,4.1027,4.2485,4.3708,4.4761,4.5682,4.6502,4.7238,4.7907,4.8519,4.9083,4.9605,5.0091,5.0546,5.0973,5.1376],
[2.8026,3.36,3.6893,3.9224,4.102,4.2478,4.3701,4.4752,4.5674,4.6493,4.7229,4.7898,4.8509,4.9072,4.9594,5.008,5.0535,5.0962,5.1364],
[2.8024,3.3596,3.6888,3.9218,4.1014,4.2471,4.3693,4.4744,4.5665,4.6484,4.722,4.7888,4.8499,4.9062,4.9584,5.007,5.0524,5.0951,5.1353],
[2.8021,3.3592,3.6883,3.9212,4.1007,4.2464,4.3686,4.4736,4.5657,4.6475,4.7211,4.7879,4.849,4.9052,4.9574,5.0059,5.0514,5.094,5.1342],
[2.8018,3.3588,3.6878,3.9206,4.1001,4.2457,4.3678,4.4729,4.5649,4.6467,4.7202,4.7869,4.848,4.9043,4.9564,5.0049,5.0503,5.0929,5.1331],
[2.8015,3.3584,3.6873,3.9201,4.0995,4.245,4.3671,4.4721,4.5641,4.6458,4.7193,4.786,4.8471,4.9033,4.9554,5.0039,5.0493,5.0919,5.132],
[2.8013,3.358,3.6869,3.9195,4.0989,4.2443,4.3664,4.4713,4.5633,4.645,4.7185,4.7852,4.8462,4.9024,4.9544,5.0029,5.0483,5.0909,5.131],
[2.801,3.3576,3.6864,3.919,4.0983,4.2437,4.3657,4.4706,4.5625,4.6442,4.7176,4.7843,4.8453,4.9015,4.9535,5.002,5.0473,5.0898,5.1299],
[2.8008,3.3573,3.6859,3.9185,4.0977,4.243,4.365,4.4699,4.5618,4.6434,4.7168,4.7834,4.8444,4.9005,4.9526,5.001,5.0463,5.0888,5.1289],
[2.8005,3.3569,3.6855,3.918,4.0971,4.2424,4.3643,4.4692,4.561,4.6426,4.716,4.7826,4.8435,4.8997,4.9516,5.0001,5.0453,5.0879,5.1279],
[2.8003,3.3565,3.685,3.9174,4.0965,4.2418,4.3637,4.4685,4.5603,4.6419,4.7152,4.7818,4.8427,4.8988,4.9507,4.9991,5.0444,5.0869,5.1269],
[2.8,3.3562,3.6846,3.9169,4.096,4.2412,4.363,4.4678,4.5596,4.6411,4.7144,4.781,4.8418,4.8979,4.9499,4.9982,5.0435,5.086,5.126]]

qdist099=[
[14.0346,19.0189,22.2935,24.7166,26.628,28.1991,29.5282,30.677,31.6866,32.5855,33.3946,34.1294,34.8018,35.4212,35.9948,36.5286,37.0277,37.4959,37.9368],
[8.2603,10.6157,12.1695,13.3241,14.2403,14.9972,15.6401,16.1978,16.6894,17.1283,17.5241,17.8844,18.2146,18.5192,18.8017,19.065,19.3113,19.5427,19.7608],
[6.5113,8.1181,9.1729,9.9579,10.5823,11.0992,11.5394,11.9253,12.2639,12.5667,12.8403,13.0897,13.3186,13.5299,13.7262,13.9093,14.0808,14.242,14.394],
[5.7024,6.9757,7.8059,8.4215,8.9131,9.3208,9.6686,9.9713,10.239,10.4787,10.6955,10.8932,11.0749,11.2428,11.3988,11.5445,11.6809,11.8093,11.9305],
[5.2427,6.3312,7.0333,7.556,7.9737,8.3179,8.6113,8.8693,9.0966,9.3003,9.4847,9.653,9.8077,9.9508,10.0838,10.208,10.3245,10.4342,10.5377],
[4.9483,5.9193,6.543,7.0061,7.373,7.6784,7.9403,8.1672,8.368,8.5478,8.7107,8.8593,8.9959,9.1242,9.2423,9.3526,9.456,9.5534,9.6454],
[4.7445,5.6353,6.2039,6.6251,6.96,7.2378,7.4748,7.6813,7.8642,8.0281,8.1766,8.3121,8.4368,8.5522,8.6595,8.7597,8.8538,8.9424,9.026],
[4.5955,5.4279,5.9567,6.3473,6.6576,6.9148,7.1344,7.3257,7.4951,7.647,7.7846,7.9103,8.026,8.133,8.2326,8.3257,8.4131,8.4953,8.573],
[4.4818,5.27,5.7686,6.1361,6.4276,6.6691,6.8751,7.0546,7.2136,7.3562,7.4854,7.6034,7.712,7.8126,7.9062,7.9936,8.0757,8.153,8.2261],
[4.3922,5.1459,5.6207,5.9701,6.2474,6.4759,6.6713,6.8415,6.9922,7.1274,7.2498,7.3617,7.4647,7.56,7.6487,7.7317,7.8095,7.8829,7.9522],
[4.3197,5.0459,5.5016,5.8363,6.1011,6.3205,6.5069,6.6696,6.8136,6.9427,7.0597,7.1665,7.2649,7.3559,7.4407,7.5199,7.5943,7.6644,7.7306],
[4.2607,4.9635,5.4036,5.7266,5.9812,6.1919,6.3715,6.5283,6.6664,6.7905,6.903,7.0057,7.1002,7.1877,7.2691,7.3453,7.4168,7.4841,7.5478],
[4.2099,4.8945,5.3215,5.634,5.8808,6.0847,6.2583,6.4095,6.5428,6.6638,6.7716,6.8708,6.9621,7.0466,7.1252,7.1988,7.2678,7.3329,7.3943],
[4.1673,4.8359,5.2518,5.5558,5.7956,5.9936,6.1621,6.3087,6.4384,6.5547,6.6596,6.7568,6.8447,6.9266,7.0028,7.0741,7.1411,7.2041,7.2637],
[4.1306,4.7855,5.1919,5.4885,5.7223,5.9152,6.0793,6.2221,6.3483,6.4615,6.5639,6.6575,6.7431,6.8236,6.8975,6.9668,7.0319,7.0932,7.1512],
[4.0987,4.7417,5.1398,5.43,5.6586,5.8471,6.0074,6.1468,6.27,6.3804,6.4804,6.5717,6.6557,6.7334,6.8058,6.8734,6.9373,6.9974,7.0533],
[4.0707,4.7032,5.0941,5.3787,5.6027,5.7873,5.9443,6.0807,6.2013,6.3093,6.4071,6.4964,6.5785,6.6546,6.7253,6.7914,6.8535,6.912,6.9673],
[4.0459,4.6693,5.0537,5.3334,5.5534,5.7345,5.8885,6.0223,6.1405,6.2464,6.3423,6.4298,6.5103,6.5848,6.6541,6.7189,6.7797,6.837,6.8911],
[4.0237,4.639,5.0178,5.2931,5.5094,5.6875,5.8388,5.9702,6.0864,6.1904,6.2845,6.3704,6.4494,6.5226,6.5906,6.6542,6.7139,6.7701,6.8232],
[4.0042,4.6119,4.9856,5.2569,5.47,5.6453,5.7943,5.9236,6.0379,6.1402,6.2327,6.3172,6.3949,6.4668,6.5337,6.5962,6.6549,6.7101,6.7623],
[3.9864,4.5874,4.9565,5.2243,5.4345,5.6074,5.7541,5.8816,5.9941,6.0949,6.186,6.2692,6.3457,6.4165,6.4823,6.5439,6.6016,6.656,6.7074],
[3.9703,4.5653,4.9302,5.1948,5.4023,5.5729,5.7178,5.8435,5.9545,6.0538,6.1437,6.2257,6.3011,6.3709,6.4358,6.4964,6.5533,6.607,6.6576],
[3.9557,4.5452,4.9063,5.1679,5.373,5.5416,5.6847,5.8088,5.9184,6.0165,6.1052,6.1861,6.2605,6.3294,6.3934,6.4532,6.5094,6.5623,6.6122],
[3.9424,4.5268,4.8844,5.1433,5.3463,5.513,5.6544,5.7771,5.8854,5.9823,6.07,6.1499,6.2234,6.2914,6.3546,6.4137,6.4692,6.5214,6.5707],
[3.9302,4.5099,4.865,5.1215,5.3223,5.4873,5.6266,5.748,5.8552,5.951,6.0376,6.1167,6.1893,6.2565,6.319,6.3774,6.4322,6.4838,6.5326],
[3.9189,4.4944,4.8466,5.1008,5.2998,5.4632,5.6017,5.7218,5.8273,5.9221,6.0079,6.0861,6.158,6.2244,6.2863,6.344,6.3982,6.4493,6.4975],
[3.9078,4.48,4.8296,5.0817,5.279,5.4409,5.5782,5.6972,5.8021,5.896,5.9803,6.0578,6.1289,6.1948,6.256,6.3131,6.3668,6.4173,6.465],
[3.8981,4.4668,4.8138,5.064,5.2597,5.4203,5.5564,5.6743,5.7784,5.8714,5.9555,6.0322,6.1026,6.1672,6.2279,6.2845,6.3376,6.3876,6.4349],
[3.8891,4.4545,4.7992,5.0476,5.2418,5.4012,5.5361,5.6531,5.7563,5.8485,5.9318,6.0079,6.0777,6.1423,6.2023,6.2584,6.3105,6.3601,6.4069],
[3.8807,4.443,4.7856,5.0323,5.2252,5.3833,5.5172,5.6333,5.7357,5.8272,5.9098,5.9852,6.0545,6.1185,6.1781,6.2337,6.2859,6.335,6.3814],
[3.8728,4.4323,4.7729,5.018,5.2096,5.3667,5.4996,5.6149,5.7164,5.8072,5.8893,5.9641,6.0328,6.0964,6.1554,6.2106,6.2623,6.3111,6.3571],
[3.8654,4.4223,4.761,5.0047,5.195,5.3511,5.4831,5.5976,5.6984,5.7886,5.8701,5.9443,6.0125,6.0756,6.1342,6.189,6.2403,6.2886,6.3343],
[3.8585,4.4129,4.7498,4.9921,5.1814,5.3364,5.4677,5.5814,5.6816,5.7711,5.852,5.9258,5.9935,6.0561,6.1143,6.1687,6.2197,6.2676,6.313],
[3.852,4.4041,4.7393,4.9804,5.1685,5.3227,5.4532,5.5662,5.6657,5.7547,5.8351,5.9083,5.9756,6.0378,6.0956,6.1496,6.2002,6.2479,6.2929],
[3.8459,4.3958,4.7294,4.9693,5.1565,5.3098,5.4395,5.5518,5.6508,5.7392,5.8191,5.8919,5.9588,6.0206,6.078,6.1317,6.182,6.2293,6.274],
[3.8402,4.388,4.7201,4.9588,5.1451,5.2976,5.4266,5.5383,5.6367,5.7247,5.8041,5.8764,5.9429,6.0043,6.0614,6.1147,6.1647,6.2117,6.2562],
[3.8347,4.3806,4.7113,4.949,5.1343,5.2861,5.4144,5.5255,5.6234,5.7109,5.7898,5.8618,5.9279,5.989,6.0457,6.0987,6.1484,6.1952,6.2393],
[3.8296,4.3737,4.703,4.9396,5.1241,5.2752,5.4029,5.5135,5.6109,5.6978,5.7764,5.848,5.9137,5.9744,6.0309,6.0836,6.133,6.1795,6.2234],
[3.8247,4.3671,4.6951,4.9308,5.1145,5.2649,5.392,5.502,5.5989,5.6855,5.7636,5.8348,5.9002,5.9606,6.0168,6.0692,6.1183,6.1646,6.2083],
[3.8201,4.3608,4.6877,4.9224,5.1053,5.2551,5.3816,5.4911,5.5876,5.6738,5.7515,5.8224,5.8875,5.9476,6.0034,6.0556,6.1045,6.1505,6.1939],
[3.8156,4.3549,4.6805,4.9144,5.0966,5.2457,5.3718,5.4808,5.5769,5.6626,5.74,5.8106,5.8753,5.9351,5.9907,6.0426,6.0913,6.1371,6.1803],
[3.8115,4.3493,4.6738,4.9068,5.0884,5.2369,5.3624,5.471,5.5666,5.652,5.7291,5.7993,5.8638,5.9233,5.9787,6.0303,6.0787,6.1243,6.1673],
[3.8075,4.3439,4.6673,4.8996,5.0805,5.2285,5.3535,5.4617,5.5569,5.6419,5.7187,5.7886,5.8528,5.9121,5.9671,6.0186,6.0668,6.1121,6.155],
[3.8037,4.3388,4.6612,4.8927,5.073,5.2204,5.345,5.4527,5.5476,5.6323,5.7087,5.7784,5.8423,5.9013,5.9562,6.0074,6.0554,6.1005,6.1432],
[3.8,4.3339,4.6553,4.8861,5.0658,5.2127,5.3369,5.4442,5.5387,5.6231,5.6992,5.7686,5.8323,5.8911,5.9457,5.9967,6.0445,6.0895,6.1319],
[3.7965,4.3293,4.6497,4.8798,5.059,5.2054,5.3291,5.4361,5.5303,5.6143,5.6902,5.7593,5.8227,5.8813,5.9357,5.9865,6.0341,6.0789,6.1212],
[3.7932,4.3248,4.6444,4.8738,5.0524,5.1984,5.3217,5.4283,5.5222,5.6059,5.6815,5.7503,5.8135,5.8719,5.9261,5.9767,6.0241,6.0687,6.1109],
[3.79,4.32,4.6392,4.8681,5.0461,5.1917,5.3146,5.4209,5.5144,5.5979,5.6732,5.7418,5.8048,5.8629,5.9169,5.9673,6.0146,6.059,6.101],
[3.787,4.3159,4.6343,4.8625,5.0401,5.1852,5.3078,5.4137,5.507,5.5902,5.6652,5.7336,5.7964,5.8543,5.9081,5.9584,6.0054,6.0497,6.0916],
[3.7841,4.3119,4.6296,4.8572,5.0343,5.179,5.3012,5.4069,5.4998,5.5828,5.6576,5.7257,5.7883,5.846,5.8997,5.9498,5.9967,6.0408,6.0825],
[3.7812,4.308,4.6251,4.8522,5.0288,5.1731,5.2949,5.4003,5.493,5.5757,5.6503,5.7182,5.7805,5.8381,5.8916,5.9415,5.9883,6.0323,6.0738],
[3.7785,4.3044,4.6207,4.8473,5.0235,5.1674,5.2889,5.394,5.4864,5.5688,5.6432,5.711,5.7731,5.8305,5.8838,5.9335,5.9802,6.024,6.0654],
[3.7759,4.3008,4.6165,4.8426,5.0183,5.1619,5.2831,5.3879,5.48,5.5623,5.6364,5.704,5.7659,5.8232,5.8763,5.9259,5.9724,6.0161,6.0574],
[3.7734,4.2974,4.612,4.838,5.0134,5.1566,5.2775,5.382,5.4739,5.5559,5.6299,5.6973,5.7591,5.8161,5.8691,5.9186,5.9649,6.0085,6.0496],
[3.771,4.2942,4.6082,4.8337,5.0087,5.1516,5.2722,5.3764,5.4681,5.5499,5.6236,5.6908,5.7524,5.8093,5.8622,5.9115,5.9577,6.0011,6.0422],
[3.7687,4.291,4.6045,4.8295,5.0041,5.1467,5.267,5.371,5.4624,5.544,5.6176,5.6846,5.746,5.8028,5.8555,5.9047,5.9507,5.9941,6.035],
[3.7665,4.288,4.6009,4.8255,4.9997,5.142,5.262,5.3657,5.457,5.5383,5.6118,5.6786,5.7399,5.7965,5.849,5.8981,5.944,5.9872,6.028],
[3.7643,4.285,4.5975,4.8216,4.9954,5.1374,5.2572,5.3607,5.4517,5.5329,5.6061,5.6728,5.7339,5.7904,5.8428,5.8917,5.9376,5.9807,6.0214],
[3.7622,4.2822,4.5942,4.8178,4.9913,5.133,5.2525,5.3558,5.4466,5.5276,5.6007,5.6672,5.7282,5.7845,5.8368,5.8856,5.9313,5.9743,6.0149],
[3.7602,4.2795,4.591,4.8141,4.9874,5.1287,5.248,5.3511,5.4417,5.5225,5.5954,5.6618,5.7226,5.7788,5.831,5.8797,5.9253,5.9682,6.0086],
[3.7583,4.2768,4.5879,4.8106,4.9835,5.1246,5.2437,5.3465,5.437,5.5176,5.5903,5.6565,5.7173,5.7733,5.8254,5.8739,5.9194,5.9622,6.0026],
[3.7564,4.2743,4.5849,4.8072,4.9798,5.1207,5.2395,5.3421,5.4324,5.5129,5.5854,5.6515,5.7121,5.768,5.8199,5.8684,5.9138,5.9565,5.9968],
[3.7546,4.2718,4.582,4.8039,4.9762,5.1168,5.2354,5.3379,5.4279,5.5083,5.5807,5.6466,5.7071,5.7629,5.8147,5.863,5.9083,5.9509,5.9911],
[3.7528,4.2694,4.5789,4.8007,4.9727,5.1131,5.2315,5.3337,5.4236,5.5038,5.5761,5.6419,5.7022,5.7579,5.8096,5.8578,5.903,5.9455,5.9856],
[3.7511,4.267,4.5767,4.7976,4.9694,5.1095,5.2277,5.3297,5.4195,5.4995,5.5716,5.6373,5.6975,5.7531,5.8047,5.8528,5.8979,5.9403,5.9803],
[3.7494,4.2648,4.5739,4.7946,4.9661,5.106,5.224,5.3258,5.4154,5.4953,5.5673,5.6328,5.6929,5.7484,5.7999,5.8479,5.8929,5.9353,5.9752],
[3.7478,4.2626,4.5713,4.7917,4.9629,5.1026,5.2204,5.3221,5.4115,5.4912,5.5631,5.6285,5.6885,5.7438,5.7952,5.8432,5.8881,5.9304,5.9702],
[3.7463,4.2605,4.5689,4.7889,4.9599,5.0993,5.2169,5.3184,5.4077,5.4873,5.559,5.6243,5.6842,5.7394,5.7907,5.8386,5.8834,5.9256,5.9654],
[3.7447,4.2584,4.5665,4.7862,4.9569,5.0961,5.2135,5.3149,5.404,5.4835,5.5551,5.6202,5.68,5.7352,5.7864,5.8341,5.8789,5.921,5.9607],
[3.7433,4.2564,4.5642,4.7835,4.954,5.093,5.2102,5.3115,5.4004,5.4797,5.5512,5.6163,5.676,5.731,5.7821,5.8298,5.8745,5.9165,5.9561],
[3.7418,4.2545,4.5619,4.7809,4.9512,5.09,5.2071,5.3081,5.3969,5.4761,5.5475,5.6125,5.672,5.727,5.778,5.8256,5.8702,5.9121,5.9517],
[3.7405,4.2526,4.5597,4.7784,4.9484,5.0871,5.204,5.3049,5.3936,5.4726,5.5439,5.6087,5.6682,5.7231,5.774,5.8215,5.866,5.9079,5.9474],
[3.7391,4.2508,4.5576,4.776,4.9458,5.0842,5.201,5.3017,5.3903,5.4692,5.5404,5.6051,5.6645,5.7193,5.7701,5.8176,5.862,5.9038,5.9432],
[3.7378,4.249,4.5555,4.7736,4.9432,5.0815,5.198,5.2986,5.3871,5.4659,5.5369,5.6016,5.6609,5.7156,5.7663,5.8137,5.8581,5.8998,5.9391],
[3.7365,4.2472,4.553,4.7713,4.9407,5.0788,5.1952,5.2957,5.384,5.4627,5.5336,5.5982,5.6573,5.712,5.7627,5.8099,5.8542,5.8959,5.9352],
[3.7353,4.2456,4.551,4.7691,4.9382,5.0762,5.1924,5.2928,5.3809,5.4595,5.5304,5.5948,5.6539,5.7085,5.7591,5.8063,5.8505,5.8921,5.9313],
[3.7341,4.2439,4.5491,4.7669,4.9359,5.0736,5.1897,5.2899,5.378,5.4565,5.5272,5.5916,5.6506,5.705,5.7556,5.8027,5.8469,5.8884,5.9276],
[3.7329,4.2423,4.5472,4.7648,4.9335,5.0711,5.1871,5.2872,5.3751,5.4535,5.5241,5.5884,5.6473,5.7017,5.7522,5.7992,5.8433,5.8848,5.9239],
[3.7317,4.2407,4.5453,4.7627,4.9313,5.0687,5.1845,5.2845,5.3723,5.4506,5.5211,5.5853,5.6442,5.6985,5.7489,5.7959,5.8399,5.8813,5.9203],
[3.7306,4.2392,4.5435,4.7602,4.9291,5.0663,5.182,5.2819,5.3696,5.4478,5.5182,5.5823,5.6411,5.6953,5.7456,5.7926,5.8365,5.8779,5.9169],
[3.7295,4.2377,4.5418,4.7583,4.9269,5.064,5.1796,5.2793,5.3669,5.445,5.5154,5.5794,5.6381,5.6922,5.7425,5.7894,5.8333,5.8745,5.9135],
[3.7284,4.2363,4.5401,4.7564,4.9248,5.0618,5.1772,5.2768,5.3643,5.4423,5.5126,5.5765,5.6351,5.6892,5.7394,5.7862,5.8301,5.8713,5.9102],
[3.7274,4.2349,4.5384,4.7545,4.9228,5.0596,5.1749,5.2744,5.3618,5.4397,5.5099,5.5737,5.6323,5.6863,5.7364,5.7832,5.8269,5.8681,5.9069],
[3.7264,4.2335,4.5368,4.7527,4.9208,5.0575,5.1726,5.272,5.3593,5.4371,5.5072,5.571,5.6295,5.6834,5.7335,5.7802,5.8239,5.865,5.9038],
[3.7254,4.2322,4.5352,4.751,4.9188,5.0554,5.1704,5.2697,5.3569,5.4346,5.5047,5.5684,5.6268,5.6806,5.7306,5.7773,5.8209,5.862,5.9007],
[3.7244,4.2308,4.5336,4.7493,4.9169,5.0533,5.1683,5.2674,5.3546,5.4322,5.5021,5.5658,5.6241,5.6779,5.7278,5.7744,5.818,5.859,5.8977],
[3.7235,4.2296,4.5321,4.7476,4.9151,5.0514,5.1662,5.2652,5.3523,5.4298,5.4997,5.5632,5.6215,5.6752,5.7251,5.7716,5.8152,5.8562,5.8948],
[3.7226,4.2283,4.5306,4.746,4.9133,5.0494,5.1641,5.2631,5.35,5.4275,5.4973,5.5608,5.6189,5.6726,5.7225,5.7689,5.8124,5.8533,5.8919],
[3.7217,4.2271,4.5292,4.7444,4.9115,5.0475,5.1621,5.261,5.3478,5.4252,5.4949,5.5583,5.6165,5.6701,5.7199,5.7663,5.8097,5.8506,5.8891],
[3.7208,4.2259,4.5277,4.7428,4.9097,5.0457,5.1601,5.2589,5.3457,5.423,5.4926,5.556,5.614,5.6676,5.7173,5.7637,5.8071,5.8479,5.8864],
[3.7199,4.2247,4.5263,4.7413,4.908,5.0438,5.1582,5.2569,5.3436,5.4208,5.4904,5.5537,5.6117,5.6652,5.7148,5.7611,5.8045,5.8453,5.8837],
[3.7191,4.2236,4.525,4.7398,4.9064,5.0421,5.1563,5.2549,5.3415,5.4187,5.4882,5.5514,5.6093,5.6628,5.7124,5.7587,5.802,5.8427,5.8811],
[3.7183,4.2224,4.5237,4.7382,4.9048,5.0403,5.1545,5.253,5.3395,5.4166,5.486,5.5492,5.6071,5.6605,5.71,5.7562,5.7995,5.8402,5.8785],
[3.7174,4.2213,4.5224,4.7371,4.9032,5.0386,5.1527,5.2511,5.3375,5.4145,5.4839,5.547,5.6048,5.6582,5.7077,5.7539,5.7971,5.8377,5.876],
[3.7167,4.2203,4.5211,4.7355,4.9016,5.037,5.1509,5.2493,5.3356,5.4125,5.4819,5.5449,5.6027,5.656,5.7054,5.7515,5.7947,5.8353,5.8736],
[3.7159,4.2192,4.5198,4.7342,4.9001,5.0353,5.1492,5.2474,5.3337,5.4106,5.4798,5.5428,5.6005,5.6538,5.7032,5.7493,5.7924,5.8329,5.8712],
[3.7151,4.2182,4.5186,4.7328,4.8986,5.0337,5.1475,5.2457,5.3319,5.4087,5.4779,5.5408,5.5984,5.6516,5.701,5.747,5.7901,5.8306,5.8688],
[3.7144,4.2172,4.5174,4.7315,4.8971,5.0322,5.1459,5.2439,5.3301,5.4068,5.4759,5.5388,5.5964,5.6496,5.6989,5.7448,5.7879,5.8284,5.8665],
[3.7137,4.2162,4.5163,4.7303,4.8957,5.0306,5.1443,5.2422,5.3283,5.405,5.474,5.5368,5.5944,5.6475,5.6968,5.7427,5.7857,5.8261,5.8643],
[3.7129,4.2152,4.5151,4.729,4.8943,5.0291,5.1427,5.2406,5.3266,5.4032,5.4722,5.5349,5.5924,5.6455,5.6947,5.7406,5.7836,5.824,5.8621],
[3.7122,4.2143,4.514,4.7278,4.8929,5.0277,5.1411,5.239,5.3249,5.4014,5.4704,5.5331,5.5905,5.6435,5.6927,5.7386,5.7815,5.8218,5.8599],
[3.7116,4.2134,4.5129,4.7266,4.8916,5.0262,5.1396,5.2374,5.3232,5.3997,5.4686,5.5312,5.5886,5.6416,5.6907,5.7365,5.7794,5.8198,5.8578],
[3.7109,4.2124,4.5118,4.7254,4.8903,5.0248,5.1381,5.2358,5.3216,5.398,5.4668,5.5294,5.5868,5.6397,5.6888,5.7346,5.7774,5.8177,5.8557],
[3.7102,4.2115,4.5108,4.7242,4.889,5.0234,5.1366,5.2343,5.32,5.3963,5.4651,5.5277,5.585,5.6378,5.6869,5.7326,5.7754,5.8157,5.8537],
[3.7096,4.2107,4.5097,4.7231,4.8877,5.0221,5.1352,5.2327,5.3184,5.3947,5.4634,5.5259,5.5832,5.636,5.685,5.7307,5.7735,5.8137,5.8517],
[3.709,4.2098,4.5087,4.722,4.8865,5.0207,5.1338,5.2313,5.3169,5.3931,5.4618,5.5242,5.5815,5.6342,5.6832,5.7289,5.7716,5.8118,5.8497],
[3.7083,4.209,4.5077,4.7209,4.8853,5.0194,5.1324,5.2298,5.3154,5.3915,5.4602,5.5226,5.5797,5.6325,5.6814,5.727,5.7698,5.8099,5.8478],
[3.7077,4.2081,4.5067,4.7194,4.8841,5.0181,5.131,5.2284,5.3139,5.39,5.4586,5.5209,5.5781,5.6308,5.6797,5.7252,5.7679,5.808,5.8459],
[3.7071,4.2073,4.5058,4.7183,4.8824,5.0169,5.1297,5.227,5.3124,5.3885,5.457,5.5193,5.5764,5.6291,5.6779,5.7235,5.7661,5.8062,5.844],
[3.7065,4.2065,4.5048,4.7172,4.8813,5.0157,5.1284,5.2256,5.311,5.387,5.4555,5.5178,5.5748,5.6274,5.6762,5.7218,5.7644,5.8044,5.8422],
[3.706,4.2057,4.5039,4.7162,4.8802,5.0144,5.1271,5.2243,5.3096,5.3856,5.454,5.5162,5.5732,5.6258,5.6746,5.7201,5.7626,5.8027,5.8404],
[3.7054,4.205,4.503,4.7152,4.8791,5.0132,5.1259,5.223,5.3082,5.3841,5.4525,5.5147,5.5717,5.6242,5.673,5.7184,5.7609,5.8009,5.8387],
[3.7048,4.2042,4.5021,4.7142,4.878,5.0121,5.1246,5.2217,5.3069,5.3827,5.4511,5.5132,5.5701,5.6226,5.6714,5.7168,5.7593,5.7992,5.8369],
[3.7043,4.2035,4.5012,4.7132,4.877,5.0109,5.1234,5.2204,5.3055,5.3814,5.4496,5.5117,5.5686,5.6211,5.6698,5.7152,5.7576,5.7976,5.8352],
[3.7038,4.2028,4.5003,4.7122,4.876,5.0098,5.1222,5.2191,5.3042,5.38,5.4482,5.5103,5.5671,5.6196,5.6682,5.7136,5.756,5.7959,5.8336],
[3.7032,4.202,4.4995,4.7113,4.875,5.0087,5.121,5.2179,5.3029,5.3787,5.4469,5.5089,5.5657,5.6181,5.6667,5.712,5.7545,5.7943,5.8319],
[3.7027,4.2013,4.4987,4.7103,4.874,5.0076,5.1199,5.2167,5.3017,5.3774,5.4455,5.5075,5.5643,5.6166,5.6652,5.7105,5.7529,5.7928,5.8303],
[3.7022,4.2006,4.4978,4.7094,4.873,5.0065,5.1187,5.2155,5.3004,5.3761,5.4442,5.5061,5.5629,5.6152,5.6637,5.709,5.7514,5.7912,5.8288],
[3.7017,4.2,4.497,4.7085,4.872,5.0055,5.1176,5.2143,5.2992,5.3748,5.4429,5.5048,5.5615,5.6138,5.6623,5.7075,5.7499,5.7897,5.8272]]






def qdist(alpha, k, df):
      """
      alpha: level of significance
	df: degrees of freedom
	k: number of dependent variables
      """
      assert alpha>=0.95 and alpha<=0.99,"Currently, Studentized Range Distribution can only be computer [0.95-0.99] range."
      assert df>2,"Degrees of freedom cannot be smaller than 2"
      assert k>=1,"Number of dependent variables cannot be smaller than 2"
      
      srd1, srd2 = qdist095[df][k], qdist099[df][k]
      
      return linearinterp(0.95, srd1,0.99,srd2,alpha)